### 响应

其实对于前端开发来说，响应一点都不陌生，在平常工作和学习中，我们经常接触关于响应的编程，例如下面的代码中我们绑定一个click事件，然后弹出一个窗口

```javascript
document.body.addEventListener("click", function() {
  alert("Hello World");
}, false);
```

这是一个非常的典型的一个响应式的场景，我们监听用户对于文档的点击事件，在用户点击了文档的一部分后，响应了这个操作弹出了一个窗口。

由于javascript的特性，大量的异步任务处理，有时候用户一个点击操作，我们可能发送一个请求或者触发一组动画，等待动画或者请求结束过后，在做处理，这个时候会产生大量的回调函数。

### 响应式编程

对于什么是响应式编程，网上有各种官方解答，这里我会以我的视角来解释下这个概念，在前端开发中，有一个非常的核心的知识----事件，每一个前端几乎都会绑定事件，然后做出一些这个事件触发过后做出的响应动作，比如点击之后做什么，页面加载完成之后做什么......如果把在这些事件看成一种数据源，当数据源发生变化的时候，我们做出对应该做的事情，相当于我们响应的这个数据源的变化，这应该就是响应式编程最核心的东西，监听某一个数据源的变化，当数据源变化的时候，我们做出相应的动作。

各位前端可以这样理解，假设我们监听了click事件，如果用户没有做任何操作，我们把这个时候click表示为状态A，当用户点击的时候click表示为状态B，当用户点击A变化到B的时候，我们去响应这个状态的变化，去做出一些操作，这就是响应式编程，某一数据源改变，而我们去响应这个改变。

### 浅入RxJS

RxJs是一个响应式编程的JS的库，网上一直对这个东西的评价：这是一个非常强大的js库，强大到小的应用使用嫌浪费，但是又没有那么复杂的应用让我们去使用它。我这里先不说别的，我们抛开RxJS响应式编程的这一部分，RxJS在我第一次使用的时候，我就觉的它解决了一个前端在代码阅读过程中非常痛苦的地狱回调的编程模式，让代码的可读性更加的清晰，看看自己现在写的代码，我觉的这个对于我来说是非常吸引我的一点。

接下来说一说RxJS本身，RxJS是利用观察者和订阅者的关系去解决响应式编程的问题，简单的理解来说，RxJS中你可以利用观察者去观察任何一切，你可以观察一个数组，观察一个变量，观察一个事件，观察一个函数，通过订阅这些观察者，以达到响应这些数据源变化的时候做出响应的目的，在RxJS中大量存在观察者这种对象以及链接各个观察者之间的一些胶水方法，并且RxJS可以在数据达到订阅者之前做出一系列的数据处理，以达到订阅者拿到自己真正想要的数据源。

```javascript
Rx.Observable.fromEvent(document.body, "keydown").filter((e) => {
	if (e.keyCode == 13) {
		return true;
	}
}).map((e) => {
	return ["Hellow World"];
}).subscribe((n) => {
	alert(n[1]);
});
```

上面的代码描述了，监听用户的键盘按下的时候的操作并且只有按Enter键的时候，数据才会达到订阅者那里，并且传递了一个字符串给订阅者供它使用，这就是RxJS最基础的用法，它将一个观察者通过链式的方式（数据也是通过这个流向订阅者发送）去处理，最终传递一些数据给订阅者。

那么稍微复杂的一点场景，比如在上述过程中，加一步远程获取数据的过程，我们该如何通过RxJS实现

```javascript
Rx.Observable.fromEvent(translateEl, "keydown").filter((e) => {
	if (e.keyCode == 13) {
		return true;
	}
}).concatMap(() => {
	return Rx.Observable.ajax(
		{ url: "test.js", method: "GET", responseType: "json"}
	).map((res) => {
		return [res.response.translation[0]];
	});
}).subscribe((n) => {
	alert(n[0]);
});
```

上述代码中我们使用了RxJS提供的胶水函数，将两个观察者合并到一个观察者中，用户最终订阅的是一个观察者，这个观察者响应了一个流（Enter- 发送请求 - 获取数据），最终拿到数据。

RxJS中就是这样通过组合各种观察者，我们可以达到响应不同的数据流所处理来的最终数据，在RxJS中一般不会产生跨作用域的变量，也不会产生地狱式的回调，逻辑也更加清晰，数据的流向也明确了，所以代码的可读性在RxJS中是比较高的。

RxJS并不如网上说的那么般高深，在我看来这个库提供了一种非常好的思路，去管理我们应用数据流向，使代码的逻辑清晰，应用逻辑更加清晰，它让我在平时的编程中更好的去思考，我所编写的应用应该如何去更好的实现，而不是一上来就开始怼各种看似有逻辑其实写出来过几天就不明所以的代码，响应式编程其实应该是一个非常值得在前端推广的编程方式，因为我们所做的工作就是响应各种数据变化，各种事件的变化，做出一些相应的改变。

